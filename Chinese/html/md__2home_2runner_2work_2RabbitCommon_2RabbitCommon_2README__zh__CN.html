<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RabbitCommon: Qt项目公共库</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="App.png"/></td>
  <td id="projectalign">
   <div id="projectname">RabbitCommon<span id="projectnumber">&#160;v2.3.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">载入中...</div>
<div class="SRStatus" id="Searching">搜索中...</div>
<div class="SRStatus" id="NoMatches">未找到</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Qt项目公共库</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md86"></a> </p><hr  />
<p><a href="#" onclick="location.href='mai'+'lto:'+'作者：'+'康林'+'（kl'+'22'+'2@1'+'26'+'.co'+'m'; return false;">作者：康林<span class="obfuscator">.nosp@m.</span>（kl2<span class="obfuscator">.nosp@m.</span>22@12<span class="obfuscator">.nosp@m.</span>6.co<span class="obfuscator">.nosp@m.</span>m</a>)</p>
<p><a href="https://github.com/KangLin/RabbitCommon/actions/workflows/build.yml"><img src="https://github.com/KangLin/RabbitCommon/actions/workflows/build.yml/badge.svg?branch=master" alt="master 编译状态" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/KangLin/RabbitCommon/actions/workflows/build.yml"><img src="https://github.com/KangLin/RabbitCommon/actions/workflows/build.yml/badge.svg?branch=develop" alt="develop 编译状态" style="pointer-events: none;" class="inline"/></a> <a href="https://ci.appveyor.com/project/KangLin/rabbitcommon"><img src="https://ci.appveyor.com/api/projects/status/cy6jwbbysuj7t1wp?svg=true" alt="Build status" class="inline"/></a></p>
<p><a class="el" href="md__2home_2runner_2work_2RabbitCommon_2RabbitCommon_2README.html">:us: 英语</a></p>
<ul>
<li>项目位置: <a href="https://github.com/KangLin/RabbitCommon">https://github.com/KangLin/RabbitCommon</a></li>
<li>镜像位置：<ul>
<li><a href="https://sourceforge.net/projects/rabbitcommon/">https://sourceforge.net/projects/rabbitcommon/</a></li>
<li><a href="https://gitlab.com/kl222/RabbitCommon">https://gitlab.com/kl222/RabbitCommon</a></li>
<li><a href="https://launchpad.net/rabbitcommon">https://launchpad.net/rabbitcommon</a></li>
<li><a href="https://invent.kde.org/kanglin/RabbitCommon">https://invent.kde.org/kanglin/RabbitCommon</a></li>
<li><a href="https://gitee.com/kl222/RabbitCommon">https://gitee.com/kl222/RabbitCommon</a></li>
<li><a href="https://bitbucket.org/kl222/rabbitcommon">https://bitbucket.org/kl222/rabbitcommon</a></li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md88"></a>
开发文档</h3>
<p><a href="https://kanglin.github.io/RabbitCommon/Chinese/html/index.html">在线开发文档</a></p>
<h3><a class="anchor" id="autotoc_md89"></a>
最后发行版本</h3>
<ul>
<li><a href="https://github.com/KangLin/RabbitCommon/releases/latest">最后发行版本</a></li>
<li>参见：<ul>
<li>语义化版本: <a href="https://semver.org/lang/zh-CN/">https://semver.org/lang/zh-CN/</a></li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md90"></a>
功能</h3>
<p>详见：<a href="https://kanglin.github.io/RabbitCommon/Chinese/html/group__API.html">应用程序接口</a></p>
<p>本人Qt项目的一些公共库，包括下列功能：</p>
<ul>
<li>[x] 图形界面<ul>
<li>[x] 关于对话框<ul>
<li><a href="https://github.com/commonmark/cmark">cmark</a>: 用于解析 MarkDown 语法</li>
</ul>
</li>
<li>[x] 在线更新</li>
<li>[x] <a href="Src/FrmStyle.h">样式(包括图标主题</a></li>
<li>[x] <a href="Src/RabbitRecentMenu.h">最近打开菜单</a></li>
<li>[x] <a href="Src/TitleBar.h">自定义标题栏</a></li>
<li>[x] <a href="Src/FolderBrowser/FolderBrowser.h">文件夹浏览器</a></li>
</ul>
</li>
<li>[x] <a href="Src/DownloadFile.h">从多个 URLs 下载同一文件</a></li>
<li>[x] <a href="Src/RabbitCommonDir.h">目录功能</a></li>
<li>[x] <a href="Src/RabbitCommonEncrypt.h">加解密</a></li>
<li>[x] <a href="Src/RabbitCommonRegister.h">注册表</a></li>
<li>[x] <a href="Src/RabbitCommonTools.h">工具</a><ul>
<li>[x] 用管理员权限执行程序</li>
<li>[x] 程序开机自启动</li>
<li>[x] 得到系统信息<ul>
<li>[x] 得到当前登录用户</li>
</ul>
</li>
<li>[x] 允许 core dump</li>
</ul>
</li>
<li>[x] cmake 函数<ul>
<li>[x] 翻译资源</li>
<li>[x] 增加目标；插件目标</li>
<li>[x] 生成 pkg-config 配置文件</li>
<li>[x] 生成 cmake 配置文件</li>
<li>[x] 删除安装</li>
</ul>
</li>
<li><p class="startli">跨平台，支持多操作系统</p><ul>
<li>[x] Windows</li>
<li>[x] Linux、Unix</li>
<li>[x] Android</li>
<li>[ ] Mac os</li>
<li>[ ] IOS</li>
</ul>
<p class="startli">Mac os 和 IOS ，本人没有相应设备，请有相应设备的同学自己编译，测试。</p>
<p class="startli">详见：<a href="https://doc.qt.io/qt-5/supported-platforms.html">Qt5 支持平台</a>、<a href="https://doc.qt.io/qt-6/supported-platforms.html">Qt6 支持平台</a>。</p>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md91"></a>
编译</h3>
<ul>
<li>建立并进入build目录 <pre class="fragment">  git clone --recursive https://github.com/KangLin/RabbitCommon.git
  cd RabbitCommon
  mkdir build
</pre></li>
<li>编译<ul>
<li><p class="startli">用 cmake </p><pre class="fragment">cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -DQt5_DIR=${QT_ROOT}/lib/cmake/Qt5
cmake --build .
</pre><ul>
<li>参数<ul>
<li>CMAKE_BUILD_TYPE: 编译类型</li>
<li>Qt5_DIR: Qt 位置</li>
<li>BUILD_DOCS: 编译 doxygen 文档</li>
<li>BUILD_APP: 编译应用程序</li>
<li>BUILD_ABOUT: 编译关于功能</li>
<li>BUILD_UPDATE: 编译在线更新功能</li>
<li>BUILD_ADMINAUTHORISER: 用管理员权限运行程序</li>
</ul>
</li>
</ul>
<p class="startli">**注意**：如果使用 MSVC ,则需要加上 -DCMAKE_BUILD_TYPE=Debug ，否则当编译 Debug 时会出现下面错误：</p>
<p class="startli">RabbitCommonTools.obj : error LNK2019: 无法解析的外部符号 "int __cdecl qInitResources_translations_RabbitCommon(void)" (?qInitResources_translations_RabbitCommon@YAHXZ)，该符号在函数 "void __cdecl g_RabbitCommon_InitResource(void)" (?g_RabbitCommon_InitResource@YAXXZ) 中被引用 RabbitCommonTools.obj : error LNK2019: 无法解析的外部符号 "int __cdecl qCleanupResources_translations_RabbitCommon(void)" (?qCleanupResources_translations_RabbitCommon@YAHXZ)，该符号在函数 "void __cdecl g_RabbitCommon_CleanResource(void)" (?g_RabbitCommon_CleanResource@YAXXZ) 中被引用</p><ul>
<li>linux <pre class="fragment">cd build
cmake .. -DCMAKE_INSTALL_PREFIX=`pwd`/install \
       -DCMAKE_BUILD_TYPE=Release \
       -DQT_DIR=... \
       -DQt5_DIR=${QT_ROOT}/lib/cmake/Qt5
cmake --build . --config Release --target install
</pre></li>
<li>windows <pre class="fragment">cd build
cmake .. -DCMAKE_INSTALL_PREFIX=`pwd`/install ^
         -DCMAKE_BUILD_TYPE=Release ^
         -DQT_DIR=... ^
         -DQt5_DIR=${QT_ROOT}/lib/cmake/Qt5
cmake --build . --config Release --target install
</pre></li>
<li>android<ul>
<li>Qt6 及以上版本 <pre class="fragment">cd build
${Qt6_DIR}/bin/qt-cmake .. -DCMAKE_BUILD_TYPE=Release
cmake --build . --config Release
</pre> 或者： <pre class="fragment">cmake .. -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=`pwd`/android-build \
    -DCMAKE_TOOLCHAIN_FILE=$Qt6_DIR/lib/cmake/Qt6/qt.toolchain.cmake
cmake --build . --config Release
</pre></li>
<li>Qt5<ul>
<li>主机是linux <pre class="fragment">  cd build
  cmake .. -DCMAKE_BUILD_TYPE=Release \
       -DCMAKE_INSTALL_PREFIX=`pwd`/android-build \
       -DCMAKE_TOOLCHAIN_FILE=${ANDROID_NDK}/build/cmake/android.toolchain.cmake \
       -DANDROID_ABI="armeabi-v7a with NEON" \
       -DANDROID_PLATFORM=android-18 \
       -DQT_DIR=... \
       -DQt5_DIR=
  cmake --build . --config Release --target all
</pre></li>
<li>主机是windows <pre class="fragment">  cd build
  cmake .. -G"Unix Makefiles" ^
     -DCMAKE_BUILD_TYPE=Release ^
     -DCMAKE_INSTALL_PREFIX=`pwd`/android-build ^
     -DCMAKE_TOOLCHAIN_FILE=${ANDROID_NDK}/build/cmake/android.toolchain.cmake ^
     -DCMAKE_MAKE_PROGRAM=${ANDROID_NDK}/prebuilt/windows-x86_64/bin/make.exe ^
     -DANDROID_PLATFORM=android-18 ^
     -DANDROID_ABI=arm64-v8a ^
     -DANDROID_ARM_NEON=ON ^
     -DQT_DIR=... \
     -DQt5_DIR=
  cmake --build . --config Release --target all
</pre></li>
<li>参数说明：https://developer.android.google.cn/ndk/guides/cmake<ul>
<li>ANDROID_ABI: 可取下列值： 目标 ABI。如果未指定目标 ABI，则 CMake 默认使用 armeabi-v7a。 <br  />
 有效的目标名称为：<ul>
<li>armeabi：带软件浮点运算并基于 ARMv5TE 的 CPU。</li>
<li>armeabi-v7a：带硬件 FPU 指令 (VFPv3_D16) 并基于 ARMv7 的设备。</li>
<li>armeabi-v7a with NEON：与 armeabi-v7a 相同，但启用 NEON 浮点指令。这相当于设置 -DANDROID_ABI=armeabi-v7a 和 -DANDROID_ARM_NEON=ON。</li>
<li>arm64-v8a：ARMv8 AArch64 指令集。</li>
<li>x86：IA-32 指令集。</li>
<li>x86_64 - 用于 x86-64 架构的指令集。</li>
</ul>
</li>
<li>ANDROID_NDK &lt;path&gt; 主机上安装的 NDK 根目录的绝对路径</li>
<li>ANDROID_PLATFORM: 如需平台名称和对应 Android 系统映像的完整列表，请参阅 <a href="https://developer.android.google.cn/ndk/guides/stable_apis.html">Android NDK 原生 API</a></li>
<li>ANDROID_ARM_MODE</li>
<li>ANDROID_ARM_NEON</li>
<li>ANDROID_STL:指定 CMake 应使用的 STL。<ul>
<li>c++_shared: 使用 libc++ 动态库</li>
<li>c++_static: 使用 libc++ 静态库</li>
<li>none: 没有 C++ 库支持</li>
<li>system: 用系统的 STL</li>
</ul>
</li>
</ul>
</li>
<li>安装 apk 到设备 <pre class="fragment"> adb install android-build-debug.apk 
</pre></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>用 qmake (已废弃，新程序请用 CMake) <pre class="fragment">cd build
qmake ../RabbitCommon.pro
make install
</pre><ul>
<li>参数<ul>
<li>BUILD_DOCS: 编译 doxygen 文档</li>
<li>BUILD_ABOUT=OFF: 关闭编译关于功能</li>
<li>BUILD_UPDATE=OFF: 关闭编译在线更新功能</li>
<li>BUILD_ADMINAUTHORISER＝OFF: 关闭用管理员权限运行程序</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>编译注意事项： 用 Qtcreate 在 windows 下编译 android 平台<ul>
<li>cmake<ul>
<li>设置 Generator 为 "Unix Makefiles"</li>
<li>设置 CMAKE_MAKE_PROGRAM 为 ${ANDROID_NDK}/prebuilt/windows-x86_64/bin/make.exe</li>
</ul>
</li>
<li><p class="startli">qmake。可能出现无法找到依赖库。(已废弃，新程序请用 CMake)</p>
<p class="startli">找不到 D:\Source\build-RabbitCommon-Android_for_armeabi_v7a_Clang_Qt_5_12_4_for_Android_ARMv7-Debug\bin\libRabbitCommon.so move libRabbitCommon.so ..\bin\libRabbitCommon.so process_begin: CreateProcess(NULL, move libRabbitCommon.so ..\bin\libRabbitCommon.so, ...) failed. make (e=2): 系统找不到指定的文件。 make[1]: [..\bin\libRabbitCommon.so] Error 2 (ignored)</p>
</li>
</ul>
</li>
</ul>
<p>其原因是 windows 下的 make 程序不能转换路径中的 \ 。 <br  />
 解决方法：用可以识别路径中的 \ 的 make 程序，例如: mingw32-make.exe。</p>
<ul>
<li>安装注意 <br  />
 Qt因为版权原因，没有提供openssl动态库，所以必须自己复制openssl的动态库到安装目录下。<ul>
<li>windows<ul>
<li>如果是32的，可以在Qt安装程序Tools\QtCreator\bin目录下，找到openssl的动态库（libeay32.dll、ssleay32.dll）</li>
<li>如果是64位，则需要自己下载openssl的二进制安装包。</li>
</ul>
</li>
<li><p class="startli">linux</p>
<p class="startli"><code> sudo apt-get install libssl1.1 </code></p>
</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md92"></a>
其它应用使用本项目</h3>
<ul>
<li>以库方式使用使用<ul>
<li><p class="startli">Qt 工程文件。(已废弃，新程序请用 CMake)</p>
<p class="startli">以 pkg-config 形式查找库。设置 PKG_CONFIG_PATH 为安装路径。</p>
</li>
<li><p class="startli">cmake</p>
<p class="startli">cmake 参数 RabbitCommon_ROOT 指定安装根目录 </p><pre class="fragment">find_package(RabbitCommon)
</pre></li>
</ul>
</li>
<li>直接用源码 <pre class="fragment">  if(NOT RabbitCommon_ROOT)
      set(RabbitCommon_ROOT $ENV{RabbitCommon_ROOT})
      if(NOT RabbitCommon_ROOT)
          set(RabbitCommon_ROOT ${CMAKE_SOURCE_DIR}/../RabbitCommon)
      endif()
  endif()
  if(RabbitCommon_ROOT AND EXISTS ${RabbitCommon_ROOT}/Src)
      message("Use RabbitCommon source code")
      add_subdirectory(${RabbitCommon_ROOT}/Src ${CMAKE_BINARY_DIR}/RabbitCommon)
  else()
      find_package(RabbitCommon)
      if(NOT RabbitCommon_FOUND)
          message("RabbitCommon_ROOT is not found. Please use one of the following ways to set it:")
          message("1. Set RabbitCommon_ROOT to the install prefix of RabbitCommon.")
          message("2. Set RabbitCommon_ROOT to source code root of RabbitCommon.")
          message("2.1 Please download the source code of RabbitCommon from https://github.com/KangLin/RabbitCommon")
          message("   ag:")
          message("       git clone https://github.com/KangLin/RabbitCommon.git ${CMAKE_SOURCE_DIR}/..")
          message("2.2 Then set cmake variable or environment variable RabbitCommon_ROOT to download root directory.")
          message("   ag:")
          message("       cmake -DRabbitCommon_ROOT=${CMAKE_SOURCE_DIR}/.. ")
          message(FATAL_ERROR "RabbitCommon_ROOT isn't set.")
      endif()
  endif()
</pre><ul>
<li>cmake工程<ul>
<li>子模块方式 <pre class="fragment">add_subdirectory(3th_libs/RabbitCommon/Src)
</pre></li>
<li>非子模块方式<ul>
<li>下载 <a class="el" href="namespaceRabbitCommon.html">RabbitCommon</a> 到与应用相同的目录 <pre class="fragment">git clone https://github.com/KangLin/RabbitCommon.git
</pre></li>
<li>引入以 add_subdirectory 本项目录 <pre class="fragment">if(NOT RabbitCommon_ROOT)
    set(RabbitCommon_ROOT $ENV{RabbitCommon_ROOT})
    if(NOT RabbitCommon_ROOT)
        set(RabbitCommon_ROOT ${CMAKE_SOURCE_DIR}/../RabbitCommon)
    endif()
endif()
if(RabbitCommon_ROOT AND EXISTS ${RabbitCommon_ROOT}/Src)
    message("Use RabbitCommon source code")
    add_subdirectory(${RabbitCommon_ROOT}/Src ${CMAKE_BINARY_DIR}/RabbitCommon)
else()
    find_package(RabbitCommon)
    if(NOT RabbitCommon_FOUND)
        message("RabbitCommon_ROOT is not found. Please use one of the following ways to set it:")
        message("1. Set RabbitCommon_ROOT to the install prefix of RabbitCommon.")
        message("2. Set RabbitCommon_ROOT to source code root of RabbitCommon.")
        message("2.1 Please download the source code of RabbitCommon from https://github.com/KangLin/RabbitCommon")
        message("   ag:")
        message("       git clone https://github.com/KangLin/RabbitCommon.git ${CMAKE_SOURCE_DIR}/..")
        message("2.2 Then set cmake variable or environment variable RabbitCommon_ROOT to download root directory.")
        message("   ag:")
        message("       cmake -DRabbitCommon_ROOT=${CMAKE_SOURCE_DIR}/.. ")
        message(FATAL_ERROR "RabbitCommon_ROOT isn't set.")
    endif()
endif()
</pre></li>
<li>在使用的工程目录CMakeLists.txt <pre class="fragment">target_link_libraries(${PROJECT_NAME} RabbitCommon)
</pre></li>
</ul>
</li>
<li>静态库 <pre class="fragment">   target_compile_definitions(${PROJECT_NAME} PRIVATE RABBITCOMMON_STATIC_DEFINE)
</pre></li>
</ul>
</li>
</ul>
</li>
<li>在程序main开始处，初始化 <pre class="fragment">  int main(int argc, char* argv[])
  {
      QApplication a(argc, argv);
      a.setApplicationName(......);
      RabbitCommon::CTools::Instance()-&gt;Init();

      ......
  }
</pre> </li>
</ul>
<h3><a class="anchor" id="autotoc_md93"></a>
功能</h3>
<p><a href="https://kanglin.github.io/RabbitCommon/Chinese/html/group__API.html">在线开发文档</a></p>
<h4><a class="anchor" id="autotoc_md94"></a>
关于对话框</h4>
<p><a href="Src/DlgAbout/DlgAbout.h">DlgAbout.h</a></p>
<ul>
<li><p class="startli">安装 Authors、 License、 ChangeLog 等文件。文件名命名规则：</p>
<p class="startli">Authors.md、License.md、ChangeLog.md是默认文件。 本地文件命名规则是在默认文件名后加上本地名。 例如：中文件： <br  />
 Authors_zh_CN.md、License_zh_CN.md、ChangeLog_zh_CN.md </p><pre class="fragment">  SET(OTHER_FILES
      ${CMAKE_SOURCE_DIR}/License.md
      ${CMAKE_SOURCE_DIR}/Authors.md
      ${CMAKE_SOURCE_DIR}/Authors_zh_CN.md
      ${CMAKE_SOURCE_DIR}/ChangeLog.md
      )
  INSTALL_FILE(SOURCES ${OTHER_FILES} DESTINATION "." COMPONENT Runtime)
</pre></li>
<li>代码中使用 <pre class="fragment">  QApplication a(argc, argv);
  a.setApplicationVersion(RabbitCommon_VERSION);
  a.setApplicationName("Calendar");
  a.setApplicationDisplayName(QObject::tr("Calendar"));

  #ifdef RABBITCOMMON
      CDlgAbout about(this);
      about.m_AppIcon = QImage(":/image/Calendar");
      about.m_szHomePage = "https://github.com/KangLin/LunarCalendar";
      #if defined (Q_OS_ANDROID)
          about.showMaximized();
      #endif
      about.exec();
  #endif
</pre></li>
<li>参见例子： <a href="https://github.com/KangLin/LunarCalendar">https://github.com/KangLin/LunarCalendar</a></li>
</ul>
<div class="image">
<img src="about.PNG" alt=""/>
<div class="caption">
关于对话框</div></div>
    <h4><a class="anchor" id="autotoc_md95"></a>
在线更新</h4>
<p><a href="Src/FrmUpdater/FrmUpdater.h">FrmUpdater.h</a></p>
<div class="fragment"><div class="line">#ifdef RABBITCOMMON</div>
<div class="line">    CFrmUpdater *fu = new CFrmUpdater();</div>
<div class="line">    fu-&gt;SetTitle(QImage(&quot;:/image/Calendar&quot;), qApp-&gt;applicationDisplayName());</div>
<div class="line">    #if defined (Q_OS_ANDROID)</div>
<div class="line">        fu-&gt;showMaximized();</div>
<div class="line">    #else</div>
<div class="line">        fu-&gt;show();</div>
<div class="line">    #endif</div>
<div class="line">#endif</div>
</div><!-- fragment --><ul>
<li>可以用 <a class="el" href="classCFrmUpdater.html#a8319ab1f7d80b1d4641f189e9e1f808d" title="Update XML file used only to generate programs">CFrmUpdater::GenerateUpdateXml()</a> 产生更新 xml 文件，可用命令行参数 &ndash;help 查看支持的命令参数 <pre class="fragment">./TasksApp --help
Usage: ./TasksApp [options]

Options:
    -h, --help                       Displays this help.
    -v, --version                    Displays version information.
    -f, --file &lt;xml file name&gt;       xml file name
    --pv &lt;Package version&gt;           Package version
    -t, --time &lt;Time&gt;                Time
    -i, --info &lt;Information&gt;         Information
    -s, --system &lt;Operating system&gt;  Operating system
    -p, --platform &lt;Platform&gt;        Platform
    -a, --arch &lt;Architecture&gt;        Architecture
    -c, --md5 &lt;MD5 checksum&gt;         MD5 checksum
    -u, --url &lt;Download url&gt;         Package download url
    --home &lt;Project home url&gt;        Project home url
    -m, --min &lt;Min update version&gt;   Min update version
</pre></li>
<li>在目标工程源码目录中增加 Update/update.xml 文件，然后在程序中指定此 xml 文件做为 CFrmUpdater::DownloadFile 的 URL 参数 <pre class="fragment">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;REDIRECT&gt;
     &lt;VERSION&gt;v2.3.4&lt;/VERSION&gt;
     &lt;WINDOWS&gt;
          &lt;URL&gt;url&lt;/URL&gt;
     &lt;/WINDOWS&gt;
     &lt;LINUX&gt;
          &lt;URL&gt;url&lt;/URL&gt;
     &lt;/LINUX&gt;
     &lt;LINUX_APPIMAGE&gt;
          &lt;URL&gt;url&lt;/URL&gt;
     &lt;/LINUX_APPIMAGE&gt;
     &lt;ANDROID&gt;
          &lt;URL&gt;url&lt;/URL&gt;
     &lt;/ANDROID&gt;   
&lt;/REDIRECT&gt;
</pre></li>
<li>参见例子： <a href="https://github.com/KangLin/LunarCalendar">https://github.com/KangLin/LunarCalendar</a></li>
</ul>
<div class="image">
<img src="update.PNG" alt=""/>
<div class="caption">
在线更新</div></div>
    <h4><a class="anchor" id="autotoc_md96"></a>
管理员权限运行程序</h4>
<p><a href="Src/AdminAuthoriser/adminauthoriser.h">adminauthoriser.h</a></p>
<ul>
<li>内部实现 <pre class="fragment">QString szCmd = "mkdir";
QStringList paras;
paras &lt;&lt; "-p" &lt;&lt; "/opt/RabbitCommonAdminAuthoriseTest";
qDebug() &lt;&lt; "RabbitCommon::AdminAuthoriser::Instance()-&gt;execute(szCmd, paras):"
    &lt;&lt; RabbitCommon::AdminAuthoriser::Instance()-&gt;execute(szCmd, paras);
</pre></li>
<li>公开接口： <pre class="fragment">RabbitCommon::CTools::ExecuteWithAdministratorPrivilege("regedit", QStringList());
</pre> </li>
</ul>
<h4><a class="anchor" id="autotoc_md97"></a>
程序开机自启动</h4>
<p><a href="Src/RabbitCommonTools.h">程序开机自启动</a> </p><pre class="fragment">    static int InstallStartRun(const QString &amp;szName = QString(),
                           const QString &amp;szPath = QString(),
                           bool bAllUser = false);
    static int RemoveStartRun(const QString &amp;szName = QString(),
                          bool bAllUser = false);
    static bool IsStartRun(const QString &amp;szName = QString(),
                       bool bAllUser = false);
</pre> <h4><a class="anchor" id="autotoc_md98"></a>
得到系统信息</h4>
<ul>
<li>得到当前登录用户 <pre class="fragment">  RabbitCommon::CTools::GetCurrentUser();
</pre></li>
<li>得到主机名 <pre class="fragment">  RabbitCommon::CTools::GetHostName();
</pre> </li>
</ul>
<h3><a class="anchor" id="autotoc_md99"></a>
使用本项目的项目</h3>
<ul>
<li><a href="https://github.com/KangLin/RabbitRemoteControl">玉兔远程控制</a></li>
<li><a href="https://github.com/KangLin/RabbitIm">玉兔即时通讯</a></li>
<li><a href="https://github.com/KangLin/Calendar">日历</a></li>
<li><a href="https://github.com/KangLin/LunarCalendar">农历日历</a></li>
<li><a href="https://github.com/KangLin/SerialPortAssistant">串口助手</a></li>
<li><a href="https://github.com/KangLin/FaceRecognizer">人脸识别</a></li>
<li><a href="https://github.com/KangLin/TransformCoordinate">坐标转换</a></li>
<li><a href="https://github.com/KangLin/ChineseChessControl">中国象棋</a></li>
</ul>
<h3><a class="anchor" id="autotoc_md100"></a>
捐赠</h3>
<div class="image">
<img src="Contribute_zh_CN.png" alt=""/>
<div class="caption">
捐赠</div></div>
    <h3><a class="anchor" id="autotoc_md101"></a>
许可协议</h3>
<p><a class="el" href="md__2home_2runner_2work_2RabbitCommon_2RabbitCommon_2License.html">License.md</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.16-->
<!-- start footer part -->
<hr class="footer"/><address class="footer">
<a href="mailto:kl222@126.com" >作者：康林 (kl222@126.com) </a>
<p/>
<a href="https://github.com/KangLin/RabbitCommon">版权所有(c) 康林工作室 保留所有权力</a>
</address>
</body>
</html>
